#ban setting accel above out hard limit

[gcode_macro M204]
description: Set ACCEL limieted by config and ACCEL_TO_DECEL as F x ACCEL
rename_existing:            M204.1
default_parameter_F:        0.5
gcode:
  {% set conf_max_accel = printer.configfile.settings.printer.max_accel|int %}
  {% if 'S' in params and params.S|int < conf_max_accel %}
  ;TODO handle P and T
    SET_VELOCITY_LIMIT ACCEL={ S } ACCEL_TO_DECEL={ S|float * F|float }
  {% else %}
    SET_VELOCITY_LIMIT ACCEL={ conf_max_accel } ACCEL_TO_DECEL={ conf_max_accel|float * F|float }
  {% endif %}